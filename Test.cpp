//  * AUTHORS: <Eitan Shenkolevski>
//  * 
//  * Date: 2021-03
//  */

#include "doctest.h"
#include "mat.hpp"
using namespace ariel;

#include <string>
#include <algorithm>
using namespace std;

/**
 * Returns the input string without the whitespace characters: space, newline and tab.
 * Requires std=c++2a.
 */
string nospaces(string input) {
	std::erase(input, ' ');
	std::erase(input, '\t');
	std::erase(input, '\n');
	std::erase(input, '\r');
	return input;
}


TEST_CASE("Good input") {
	CHECK(nospaces(mat(9, 7, '@', '-')) == nospaces("@@@@@@@@@\n"   //More columns than rows
													 "@-------@\n"
													 "@-@@@@@-@\n"
													 "@-@---@-@\n"
													 "@-@@@@@-@\n"
													 "@-------@\n"
													 "@@@@@@@@@"));
    CHECK(nospaces(mat(11,5,'%','!'))==nospaces("%%%%%%%%%%%\n"
                                                "%!!!!!!!!!%\n"
                                                "%!%%%%%%%!%\n"
                                                "%!!!!!!!!!%\n"
                                                "%%%%%%%%%%%"));
    CHECK(nospaces(mat(1,5,'%','!'))== nospaces("%\n"   //1 column
                                                "%\n"
                                                "%\n"
                                                "%\n"
                                                "%\n"));
    CHECK(nospaces(mat(7,1,'&','!'))==nospaces("&&&&&&&"));  //1 row

    CHECK(nospaces(mat(3,3,'*','@'))==nospaces("***\n"
                                               "*@*\n"
                                               "***"));
    CHECK(nospaces(mat(1, 1, '^', '-')) == nospaces("^"));  //1 row && 1 column

    CHECK(nospaces(mat(53, 19, '%', '!')) ==   nospaces("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"
                                                        "%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%"
                                                        "%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%"
                                                        "%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%"
                                                        "%!%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%!%"
                                                        "%!%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%!%"
                                                        "%!%!%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%!%!%"
                                                        "%!%!%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%!%!%"
                                                        "%!%!%!%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%!%!%!%"
                                                        "%!%!%!%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%!%!%!%"
                                                        "%!%!%!%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%!%!%!%"
                                                        "%!%!%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%!%!%"
                                                        "%!%!%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%!%!%"
                                                        "%!%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%!%"
                                                        "%!%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%!%"
                                                        "%!%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%!%"
                                                        "%!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%!%"
                                                        "%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!%"
                                                        "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%")); 

    CHECK(nospaces(mat(5,7,'*','('))==nospaces("*****"   //More rows than columns
                                               "*(((*"
                                               "*(*(*"
                                               "*(*(*"
                                               "*(*(*"
                                               "*(((*"
                                               "*****"));
    CHECK(nospaces(mat(5,5,'w','r'))== nospaces("wwwww"
                                                "wrrrw"
                                                "wrwrw"
                                                "wrrrw"
                                                "wwwww"));
    CHECK(nospaces(mat(13,3,'%','!'))==nospaces("%%%%%%%%%%%%%"
                                                "%!!!!!!!!!!!%"
                                                "%%%%%%%%%%%%%"));
    CHECK(nospaces(mat(77,25,'@','^')) ==  nospaces("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" //large numbers
                                                    "@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@"
                                                    "@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@"
                                                    "@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@"
                                                    "@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@"
                                                    "@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@"
                                                    "@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@"
                                                    "@^@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@^@"
                                                    "@^@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@^@"
                                                    "@^@^@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@^@^@"
                                                    "@^@^@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@^@^@"
                                                    "@^@^@^@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@^@^@^@"
                                                    "@^@^@^@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@^@^@^@"
                                                    "@^@^@^@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@^@^@^@"
                                                    "@^@^@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@^@^@"
                                                    "@^@^@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@^@^@"
                                                    "@^@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@^@"
                                                    "@^@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@^@"
                                                    "@^@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@^@"
                                                    "@^@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@^@"
                                                    "@^@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@^@"
                                                    "@^@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@^@"
                                                    "@^@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^@"
                                                    "@^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^@"
                                                    "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"));
}

TEST_CASE("Bad input") {
    CHECK_THROWS(mat(10, 5, '$', '%')); //tests with even numbers
    CHECK_THROWS(mat(9, 4, '!', '#'));
    CHECK_THROWS(mat(8, 4, '!', '#'));
    CHECK_THROWS(mat(-5, -7, '#', '%')); //tests with negative numbers
    CHECK_THROWS(mat(-3, 5, '#', '%'));
    CHECK_THROWS(mat(9, -5, '!', '%'));
    CHECK_THROWS(mat(3, 0, '#', '%'));  //tests with zeros
    CHECK_THROWS(mat(0, 7, '#', '%'));
    CHECK_THROWS(mat(0, 0, '#', '%'));
    CHECK_THROWS(mat(9, 5, '\n', '%'));  //tests with bad symbol
    CHECK_THROWS(mat(3, 7, '#', '\r'));
    CHECK_THROWS(mat(3, 7, ' ', '%'));
    CHECK_THROWS(mat(11, 15, '#', '\t'));
}
